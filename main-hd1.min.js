(async()=>{!async function t(){let e="\uD83C\uDFAF Ho·∫°t ƒë·ªông: ƒêi·ªÉm danh";if(!window.confetti){let n=document.createElement("script");n.src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js",document.head.appendChild(n)}function s(t,e,n){let s=document.createElement("div");s.style.position="fixed",s.style.bottom="20px",s.style.right="20px",s.style.maxWidth="320px",s.style.backgroundColor="success"===t?"#d4edda":"#f8d7da",s.style.color="success"===t?"#155724":"#721c24",s.style.border="1px solid",s.style.borderColor="success"===t?"#c3e6cb":"#f5c6cb",s.style.padding="15px",s.style.borderRadius="8px",s.style.boxShadow="0 0 10px rgba(0,0,0,0.2)",s.style.zIndex=9999,s.style.fontFamily="sans-serif",s.style.opacity=0,s.style.transition="opacity 0.5s ease",s.innerHTML=`
      <strong style="display:block;margin-bottom:5px;">
        ${"success"===t?"‚úÖ":"‚ùå"} ${e}
      </strong>
      <div style="margin-bottom:5px;">${n}</div>
    `,document.body.appendChild(s),requestAnimationFrame(()=>s.style.opacity=1),setTimeout(()=>{s.style.opacity=0,setTimeout(()=>s.remove(),600)},8e3)}let o=window.customRestNonce;if(!o){console.error("[DiemDanh] Kh\xf4ng t\xecm th·∫•y nonce!"),s("error",e,"Kh\xf4ng th·ªÉ th·ª±c hi·ªán ƒëi·ªÉm danh.");return}try{let i=await fetch("https://hoathinh3d.team/wp-json/hh3d/v1/action",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":o},body:JSON.stringify({action:"daily_check_in"})}),a=await i.json();a.success?(s("success",e,a.message||"ƒê\xe3 ghi nh·∫≠n ƒëi·ªÉm danh!"),console.log("[DiemDanh] Th\xe0nh c\xf4ng:",a),window.confetti&&confetti({particleCount:150,spread:80,origin:{y:.6}})):(s("error",e,a.message||"Kh\xf4ng r\xf5 l·ªói"),console.error("[DiemDanh] L·ªói:",a))}catch(c){console.error("[DiemDanh] L·ªói khi g·ª≠i y\xeau c·∫ßu:",c),s("error",e,"Kh\xf4ng th·ªÉ k·∫øt n·ªëi t·ªõi m\xe1y ch·ªß.")}}(),async function t(){if(!window.confetti){let e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js",document.head.appendChild(e)}function n(t,e="success"){let n=document.createElement("div");n.style.position="fixed",n.style.bottom="20px",n.style.right="20px",n.style.maxWidth="320px",n.style.backgroundColor="success"===e?"#d4edda":"#f8d7da",n.style.color="success"===e?"#155724":"#721c24",n.style.border="1px solid",n.style.borderColor="success"===e?"#c3e6cb":"#f5c6cb",n.style.padding="15px",n.style.borderRadius="8px",n.style.boxShadow="0 0 10px rgba(0,0,0,0.2)",n.style.zIndex=9999,n.style.fontFamily="sans-serif",n.style.opacity=0,n.style.transition="opacity 0.5s ease",n.innerHTML=`
      <strong style="display:block;margin-bottom:5px;">
        ${"success"===e?"‚úÖ":"‚ùå"} ${"success"===e?"T·∫ø L·ªÖ Th\xe0nh C\xf4ng":"T·∫ø L·ªÖ Th·∫•t B·∫°i"}
      </strong>
      <div style="margin-bottom:10px;">${t}</div>
    `,document.body.appendChild(n),requestAnimationFrame(()=>n.style.opacity=1),setTimeout(()=>{n.style.opacity=0,setTimeout(()=>n.remove(),600)},8e3)}let s=window.customRestNonce;if(!s){n("Kh\xf4ng t\xecm th·∫•y customRestNonce trong trang!","error");return}try{let o=await fetch("https://hoathinh3d.team/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"te_le_tong_mon",nonce:s})}),i=await o.json(),a="string"==typeof i.data?i.data:i.data?.message||i.message||"Kh\xf4ng r\xf5 k·∫øt qu·∫£.",c=a.toLowerCase(),r=!0===i.success,l=["ƒë\xe3 t·∫ø l·ªÖ","ƒë·∫°o h·ªØu ƒë\xe3 t·∫ø l·ªÖ"].some(t=>c.includes(t)),h=["l·ªói","th·∫•t b·∫°i","kh\xf4ng"].some(t=>c.includes(t));r||l&&!h?(n(a,"success"),window.confetti&&confetti({particleCount:120,spread:60,origin:{y:.6}}),console.log("‚úÖ T·∫ø L·ªÖ:",a)):(n(a,"error"),console.warn("‚ö†Ô∏è T·∫ø L·ªÖ L·ªói:",a))}catch(d){n("L·ªói g·ª≠i y\xeau c·∫ßu t·∫ø l·ªÖ!","error"),console.error("‚ùå T·∫ø L·ªÖ Exception:",d)}}(),async function t(){let e=t=>t.toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").replace(/\s+/g," ").trim(),n={};for(let s in answerBank)n[e(s)]=answerBank[s];async function o(){let t=await fetch("/wp-content/themes/halimmovies-child/hh3d-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"load_quiz_data"})});return t.json()}async function i(t,e){let n=await fetch("/wp-content/themes/halimmovies-child/hh3d-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"save_quiz_result",question_id:t,answer:e})});return n.json()}let a=await o();if(!a.success||!a.data?.questions){console.warn("‚ùå Kh\xf4ng th·ªÉ l·∫•y c\xe2u h·ªèi quiz.");return}if(a.data.completed){console.log("‚úÖ Quiz ƒë\xe3 ho\xe0n th\xe0nh h\xf4m nay.");return}let c=a.data.questions.filter(t=>"0"===t.is_correct),r=0,l=[];for(;c.length>0;){let h=c[0],d=e(h.question),p=n[d];if(!p){console.warn("‚ö†Ô∏è Kh\xf4ng t\xecm th·∫•y ƒë\xe1p \xe1n cho:",h.question),l.push(h.question),c.shift();continue}let y=h.options.findIndex(t=>e(t)===e(p));if(-1===y){console.warn("‚ùó Kh\xf4ng kh·ªõp ƒë\xe1p \xe1n v·ªõi options:",h.options),l.push(h.question),c.shift();continue}let u=!1;for(let m=0;m<3&&!u;m++)try{let g=await i(h.id,y);g&&g.success?(console.log(`‚úÖ C\xe2u ${++r}: ${h.question}
‚û°Ô∏è ƒê\xe1p \xe1n: ${p}`),u=!0,c.shift()):(console.warn("‚ùå BE kh\xf4ng ph·∫£n h·ªìi th\xe0nh c\xf4ng. Th·ª≠ l·∫°i..."),await new Promise(t=>setTimeout(t,500)))}catch($){console.error("\uD83D\uDEA8 L·ªói submit:",$),await new Promise(t=>setTimeout(t,1e3))}u||(l.push(h.question),c.shift())}l.length>0?(console.warn(`‚ö†Ô∏è C\xf3 ${l.length} c\xe2u b·ªã b·ªè qua:`),l.forEach((t,e)=>console.warn(`${e+1}. ${t}`)),console.log(`üìå ƒê\xe3 tr·∫£ l·ªùi ƒë\xfang ${r} / ${r+l.length} c\xe2u.`)):console.log(`üéâ Ho\xe0n t·∫•t Quiz. ƒê\xe3 tr·∫£ l·ªùi ƒë\xfang to\xe0n b·ªô ${r} c\xe2u.`)}(),(async()=>{await autoAnswerQuiz(),await runDiemDanh(),await runTele()})()})();
